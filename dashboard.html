<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Noon Recruitment Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: linear-gradient(135deg, #FFD600 0%, #FFC700 100%);
            font-family: 'Cairo', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            padding: 20px;
            min-height: 100vh;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        
        /* Header */
        .header {
            background: #111;
            color: #FFD600;
            padding: 20px 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .header h1 {
            font-size: 1.8em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .noon-logo {
            width: 60px;
            height: 60px;
            background: #FFD600;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #111;
            font-size: 1.2em;
        }
        
        /* Language Switcher */
        .lang-switcher {
            display: flex;
            gap: 10px;
            background: rgba(255,214,0,0.2);
            padding: 5px;
            border-radius: 8px;
        }
        .lang-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: #FFD600;
            cursor: pointer;
            border-radius: 6px;
            font-weight: 600;
            transition: all 0.3s;
        }
        .lang-btn.active {
            background: #FFD600;
            color: #111;
        }
        .lang-btn:hover { opacity: 0.8; }
        
        /* Filters */
        .filters {
            background: #111;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        }
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .filter-group label {
            color: #FFD600;
            font-size: 0.85em;
            font-weight: 600;
        }
        .filter-group select {
            padding: 8px 12px;
            border: 2px solid #FFD600;
            border-radius: 6px;
            background: #222;
            color: #FFD600;
            font-weight: 600;
            cursor: pointer;
        }
        .refresh-btn {
            background: #FFD600;
            color: #111;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            margin-left: auto;
            transition: all 0.3s;
        }
        .refresh-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(255,214,0,0.4); }
        
        /* Stats Grid */
        #stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .stat-card {
            background: #fff;
            border: 3px solid #111;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.25);
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #FFD600, #111);
        }
        .stat-card h3 {
            color: #111;
            font-size: 0.95em;
            margin-bottom: 15px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .stat-card .stat-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #111;
            margin-bottom: 5px;
        }
        .stat-card .stat-label {
            font-size: 0.85em;
            color: #666;
            font-weight: 500;
        }
        .stat-trend {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            margin-top: 8px;
        }
        .trend-up { background: #d4edda; color: #155724; }
        .trend-down { background: #f8d7da; color: #721c24; }
        
        /* Charts Grid */
        #charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .chart-card {
            background: #fff;
            border: 3px solid #111;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        .chart-card h3 {
            color: #111;
            font-size: 1.1em;
            margin-bottom: 20px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 3px solid #FFD600;
            padding-bottom: 10px;
        }
        
        /* Recent Applicants Table */
        .recent-table {
            background: #fff;
            border: 3px solid #111;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        .recent-table h3 {
            color: #111;
            font-size: 1.1em;
            margin-bottom: 20px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 3px solid #FFD600;
            padding-bottom: 10px;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            background: #111;
            color: #FFD600;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9em;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
            color: #333;
            font-size: 0.9em;
        }
        tr:hover td {
            background: #fffbeb;
        }
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }
        .badge-success { background: #d4edda; color: #155724; }
        .badge-warning { background: #fff3cd; color: #856404; }
        .badge-danger { background: #f8d7da; color: #721c24; }
        
        @media (max-width: 768px) {
            #charts-grid { grid-template-columns: 1fr; }
            .header { flex-direction: column; gap: 15px; text-align: center; }
            .filters { flex-direction: column; }
            .refresh-btn { margin-left: 0; width: 100%; }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>
            <div class="noon-logo">noon</div>
            <span data-en="Recruitment Dashboard" data-ar="ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ™Ÿàÿ∏ŸäŸÅ">Recruitment Dashboard</span>
        </h1>
        <div class="lang-switcher">
            <button class="lang-btn active" onclick="switchLang('en')">EN</button>
            <button class="lang-btn" onclick="switchLang('ar')">AR</button>
        </div>
    </div>
    
    <div class="filters">
        <div class="filter-group">
            <label data-en="Emirate" data-ar="ÿßŸÑÿ•ŸÖÿßÿ±ÿ©">Emirate</label>
            <select id="filter-emirate" onchange="applyFilters()">
                <option value="all" data-en="All" data-ar="ÿßŸÑŸÉŸÑ">All</option>
            </select>
        </div>
        <div class="filter-group">
            <label data-en="Has Vehicle" data-ar="ŸÑÿØŸäŸá ŸÖÿ±ŸÉÿ®ÿ©">Has Vehicle</label>
            <select id="filter-vehicle" onchange="applyFilters()">
                <option value="all" data-en="All" data-ar="ÿßŸÑŸÉŸÑ">All</option>
                <option value="yes" data-en="Yes" data-ar="ŸÜÿπŸÖ">Yes</option>
                <option value="no" data-en="No" data-ar="ŸÑÿß">No</option>
            </select>
        </div>
        <div class="filter-group">
            <label data-en="Experience" data-ar="ÿßŸÑÿÆÿ®ÿ±ÿ©">Experience</label>
            <select id="filter-experience" onchange="applyFilters()">
                <option value="all" data-en="All" data-ar="ÿßŸÑŸÉŸÑ">All</option>
                <option value="yes" data-en="Yes" data-ar="ŸÜÿπŸÖ">Yes</option>
                <option value="no" data-en="No" data-ar="ŸÑÿß">No</option>
            </select>
        </div>
        <button class="refresh-btn" onclick="loadData()" data-en="üîÑ Refresh Data" data-ar="üîÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™">üîÑ Refresh Data</button>
    </div>
    
    <div id="stats-grid">
        <div class="stat-card">
            <h3 data-en="Total Applicants" data-ar="ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖŸäŸÜ">Total Applicants</h3>
            <div class="stat-value" id="total-applicants">0</div>
            <div class="stat-label" data-en="All time" data-ar="ÿπŸÑŸâ ÿßŸÑÿ•ÿ∑ŸÑÿßŸÇ">All time</div>
        </div>
        <div class="stat-card">
            <h3 data-en="Qualified (Vehicle + Experience)" data-ar="ÿßŸÑŸÖÿ§ŸáŸÑŸäŸÜ (ÿ≥Ÿäÿßÿ±ÿ©+ÿÆÿ®ÿ±ÿ©)">Qualified (Vehicle + Experience)</h3>
            <div class="stat-value" id="total-qualified">0</div>
            <div class="stat-label" id="qualified-percent">0%</div>
        </div>
        <div class="stat-card">
            <h3 data-en="Available Immediately" data-ar="ŸÖÿ™ÿßÿ≠ŸäŸÜ ŸÅŸàÿ±ÿßŸã">Available Immediately</h3>
            <div class="stat-value" id="total-available">0</div>
            <div class="stat-label" id="available-percent">0%</div>
        </div>
        <div class="stat-card">
            <h3 data-en="Today's Applications" data-ar="ŸÖÿ™ŸÇÿØŸÖŸäŸÜ ÿßŸÑŸäŸàŸÖ">Today's Applications</h3>
            <div class="stat-value" id="total-today">0</div>
            <div class="stat-label" data-en="Last 24 hours" data-ar="ÿ¢ÿÆÿ± 24 ÿ≥ÿßÿπÿ©">Last 24 hours</div>
        </div>
        <div class="stat-card">
            <h3 data-en="With Valid License" data-ar="ÿ®ÿ±ÿÆÿµÿ© ÿ≥ÿßÿ±Ÿäÿ©">With Valid License</h3>
            <div class="stat-value" id="total-license">0</div>
            <div class="stat-label" id="license-percent">0%</div>
        </div>
        <div class="stat-card">
            <h3 data-en="This Week" data-ar="Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ">This Week</h3>
            <div class="stat-value" id="total-week">0</div>
            <div class="stat-label" data-en="Last 7 days" data-ar="ÿ¢ÿÆÿ± 7 ÿ£ŸäÿßŸÖ">Last 7 days</div>
        </div>
    </div>
    
    <div id="charts-grid">
        <div class="chart-card">
            <h3 data-en="Applicants by Emirate" data-ar="ÿßŸÑŸÖÿ™ŸÇÿØŸÖŸäŸÜ ÿ≠ÿ≥ÿ® ÿßŸÑÿ•ŸÖÿßÿ±ÿ©">Applicants by Emirate</h3>
            <canvas id="emirate-chart"></canvas>
        </div>
        <div class="chart-card">
            <h3 data-en="Qualifications Overview" data-ar="ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ© ÿπŸÑŸâ ÿßŸÑŸÖÿ§ŸáŸÑÿßÿ™">Qualifications Overview</h3>
            <canvas id="qualified-chart"></canvas>
        </div>
        <div class="chart-card">
            <h3 data-en="Applications Trend (Last 7 Days)" data-ar="ÿßÿ™ÿ¨ÿßŸá ÿßŸÑÿ™ŸÇÿØŸäŸÖÿßÿ™ (ÿ¢ÿÆÿ± 7 ÿ£ŸäÿßŸÖ)">Applications Trend (Last 7 Days)</h3>
            <canvas id="trend-chart"></canvas>
        </div>
        <div class="chart-card">
            <h3 data-en="Availability Status" data-ar="ÿ≠ÿßŸÑÿ© ÿßŸÑÿ™ŸàŸÅÿ±">Availability Status</h3>
            <canvas id="availability-chart"></canvas>
        </div>
    </div>
    
    <div class="recent-table">
        <h3 data-en="Recent Applications" data-ar="ÿßŸÑÿ™ŸÇÿØŸäŸÖÿßÿ™ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©">Recent Applications</h3>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th data-en="Name" data-ar="ÿßŸÑÿßÿ≥ŸÖ">Name</th>
                        <th data-en="Emirate" data-ar="ÿßŸÑÿ•ŸÖÿßÿ±ÿ©">Emirate</th>
                        <th data-en="Vehicle" data-ar="ŸÖÿ±ŸÉÿ®ÿ©">Vehicle</th>
                        <th data-en="Experience" data-ar="ÿÆÿ®ÿ±ÿ©">Experience</th>
                        <th data-en="Status" data-ar="ÿßŸÑÿ≠ÿßŸÑÿ©">Status</th>
                        <th data-en="Date" data-ar="ÿßŸÑÿ™ÿßÿ±ŸäÿÆ">Date</th>
                    </tr>
                </thead>
                <tbody id="recent-tbody">
                    <tr><td colspan="6" style="text-align:center;" data-en="Loading..." data-ar="ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...">Loading...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
// Configuration
const SHEET_ID = '1AGpZc2JY9Yd190bPmH2Twkxe2ZccuxjRySgw3RI_vFm2XEyzrTLewXH5';
const API_KEY = 'oqecI-NOhnH-5Kc5z-WsTdT-afhX6-hkJyk-SXfO6-eRfBa';
let allData = [];
let currentLang = 'en';
let charts = {};

// Language switching
function switchLang(lang) {
    currentLang = lang;
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent === lang.toUpperCase()) {
            btn.classList.add('active');
        }
    });
    
    document.querySelectorAll('[data-en]').forEach(el => {
        el.textContent = el.getAttribute('data-' + lang);
    });
}

// Load data from Google Sheets
function loadData() {
    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Sheet1!A:K?key=${API_KEY}`)
        .then(r => r.json())
        .then(d => {
            allData = d.values.slice(1);
            populateFilters();
            applyFilters();
        })
        .catch(err => {
            console.error('Error loading data:', err);
            document.getElementById('total-applicants').textContent = 'Error';
        });
}

// Populate filter dropdowns
function populateFilters() {
    const emirates = [...new Set(allData.map(r => r[3]).filter(Boolean))];
    const emirateSelect = document.getElementById('filter-emirate');
    const options = ['<option value="all">All</option>'];
    emirates.forEach(e => {
        options.push(`<option value="${escapeHtml(e)}">${escapeHtml(e)}</option>`);
    });
    emirateSelect.innerHTML = options.join('');
}

// Apply filters
function applyFilters() {
    const emirateFilter = document.getElementById('filter-emirate').value;
    const vehicleFilter = document.getElementById('filter-vehicle').value;
    const experienceFilter = document.getElementById('filter-experience').value;
    
    let filtered = allData.filter(row => {
        if (emirateFilter !== 'all' && row[3] !== emirateFilter) return false;
        if (vehicleFilter === 'yes' && row[6] !== 'Yes' && row[6] !== 'ŸÜÿπŸÖ') return false;
        if (vehicleFilter === 'no' && (row[6] === 'Yes' || row[6] === 'ŸÜÿπŸÖ')) return false;
        if (experienceFilter === 'yes' && row[8] !== 'Yes' && row[8] !== 'ŸÜÿπŸÖ') return false;
        if (experienceFilter === 'no' && (row[8] === 'Yes' || row[8] === 'ŸÜÿπŸÖ')) return false;
        return true;
    });
    
    updateStats(filtered);
    updateCharts(filtered);
    updateRecentTable(filtered);
}

// Update statistics
function updateStats(data) {
    const total = data.length;
    
    // Column structure: 0=Name, 1=Phone, 2=Email, 3=Emirate, 4=License, 5=Residency, 6=Vehicle, 7=VehicleType, 8=DeliveryExp, 9=Available, 10=Timestamp
    const hasVehicle = data.filter(r => r[6] === 'Yes' || r[6] === 'ŸÜÿπŸÖ').length;
    const hasExperience = data.filter(r => r[8] === 'Yes' || r[8] === 'ŸÜÿπŸÖ').length;
    const qualified = data.filter(r => (r[6] === 'Yes' || r[6] === 'ŸÜÿπŸÖ') && (r[8] === 'Yes' || r[8] === 'ŸÜÿπŸÖ')).length;
    const available = data.filter(r => r[9] === 'Yes' || r[9] === 'ŸÜÿπŸÖÿå ŸÖÿ™ÿßÿ≠ ŸÅŸàÿ±ÿßŸã').length;
    const hasLicense = data.filter(r => r[4] === 'Yes' || r[4] === 'ŸÜÿπŸÖ').length;
    
    const today = new Date().toDateString();
    const todayCount = data.filter(r => r[10] && new Date(r[10]).toDateString() === today).length;
    
    const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
    const weekCount = data.filter(r => r[10] && new Date(r[10]) >= weekAgo).length;
    
    document.getElementById('total-applicants').textContent = total;
    document.getElementById('total-qualified').textContent = qualified;
    document.getElementById('qualified-percent').textContent = total ? `${Math.round(qualified/total*100)}% of total` : '0%';
    document.getElementById('total-available').textContent = available;
    document.getElementById('available-percent').textContent = total ? `${Math.round(available/total*100)}% of total` : '0%';
    document.getElementById('total-today').textContent = todayCount;
    document.getElementById('total-license').textContent = hasLicense;
    document.getElementById('license-percent').textContent = total ? `${Math.round(hasLicense/total*100)}% of total` : '0%';
    document.getElementById('total-week').textContent = weekCount;
}

// Update charts
function updateCharts(data) {
    const total = data.length;
    
    // Emirate distribution
    const emirates = {};
    data.forEach(r => {
        const emirate = r[3] || 'Unspecified';
        emirates[emirate] = (emirates[emirate] || 0) + 1;
    });
    
    if (charts.emirate) charts.emirate.destroy();
    charts.emirate = new Chart(document.getElementById('emirate-chart'), {
        type: 'bar',
        data: {
            labels: Object.keys(emirates),
            datasets: [{
                label: 'Applicants',
                data: Object.values(emirates),
                backgroundColor: '#FFD600',
                borderColor: '#111',
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                y: { beginAtZero: true, ticks: { stepSize: 1 } }
            }
        }
    });
    
    // Qualifications overview
    const hasVehicle = data.filter(r => r[6] === 'Yes' || r[6] === 'ŸÜÿπŸÖ').length;
    const hasExperience = data.filter(r => r[8] === 'Yes' || r[8] === 'ŸÜÿπŸÖ').length;
    const hasLicense = data.filter(r => r[4] === 'Yes' || r[4] === 'ŸÜÿπŸÖ').length;
    const hasResidency = data.filter(r => r[5] === 'Yes' || r[5] === 'ŸÜÿπŸÖ').length;
    
    if (charts.qualified) charts.qualified.destroy();
    charts.qualified = new Chart(document.getElementById('qualified-chart'), {
        type: 'doughnut',
        data: {
            labels: ['Has Vehicle', 'Has Experience', 'Has License', 'Has Residency'],
            datasets: [{
                data: [hasVehicle, hasExperience, hasLicense, hasResidency],
                backgroundColor: ['#FFD600', '#111', '#FFA500', '#FFE066'],
                borderWidth: 3,
                borderColor: '#fff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });
    
    // Trend chart (last 7 days)
    const last7Days = [];
    for (let i = 6; i >= 0; i--) {
        const date = new Date(Date.now() - i * 24 * 60 * 60 * 1000);
        date.setHours(0, 0, 0, 0);
        last7Days.push(date);
    }
    
    const trendData = last7Days.map(date => {
        return data.filter(r => {
            if (!r[10]) return false;
            const rowDate = new Date(r[10]);
            rowDate.setHours(0, 0, 0, 0);
            return rowDate.getTime() === date.getTime();
        }).length;
    });
    
    if (charts.trend) charts.trend.destroy();
    charts.trend = new Chart(document.getElementById('trend-chart'), {
        type: 'line',
        data: {
            labels: last7Days.map(d => d.toLocaleDateString('en', { month: 'short', day: 'numeric' })),
            datasets: [{
                label: 'Applications',
                data: trendData,
                borderColor: '#111',
                backgroundColor: 'rgba(255, 214, 0, 0.2)',
                borderWidth: 3,
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                y: { beginAtZero: true, ticks: { stepSize: 1 } }
            }
        }
    });
    
    // Availability status
    const immediatelyAvailable = data.filter(r => r[9] === 'Yes' || r[9] === 'ŸÜÿπŸÖÿå ŸÖÿ™ÿßÿ≠ ŸÅŸàÿ±ÿßŸã').length;
    const availableInMonth = data.filter(r => r[9] === 'Within One Month' || r[9] === 'ŸÑÿß (ŸÖÿ™ÿßÿ≠ ÿÆŸÑÿßŸÑ ÿ¥Ÿáÿ±)').length;
    
    if (charts.availability) charts.availability.destroy();
    charts.availability = new Chart(document.getElementById('availability-chart'), {
        type: 'pie',
        data: {
            labels: ['Available Immediately', 'Available in 1 Month', 'Not Specified'],
            datasets: [{
                data: [immediatelyAvailable, availableInMonth, total - immediatelyAvailable - availableInMonth],
                backgroundColor: ['#28a745', '#FFD600', '#dc3545'],
                borderWidth: 3,
                borderColor: '#fff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });
}

// Update recent applications table
function updateRecentTable(data) {
    const tbody = document.getElementById('recent-tbody');
    const recent = data.slice(-10).reverse();
    
    if (recent.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;">No data available</td></tr>';
        return;
    }
    
    tbody.innerHTML = recent.map(row => {
        const name = escapeHtml(row[0] || 'N/A');
        const emirate = escapeHtml(row[3] || 'N/A');
        const vehicle = (row[6] === 'Yes' || row[6] === 'ŸÜÿπŸÖ') ? '<span class="badge badge-success">Yes</span>' : '<span class="badge badge-danger">No</span>';
        const experience = (row[8] === 'Yes' || row[8] === 'ŸÜÿπŸÖ') ? '<span class="badge badge-success">Yes</span>' : '<span class="badge badge-danger">No</span>';
        const available = (row[9] === 'Yes' || row[9] === 'ŸÜÿπŸÖÿå ŸÖÿ™ÿßÿ≠ ŸÅŸàÿ±ÿßŸã') ? '<span class="badge badge-success">Immediate</span>' : '<span class="badge badge-warning">Later</span>';
        const date = row[10] ? escapeHtml(new Date(row[10]).toLocaleDateString()) : 'N/A';
        
        return `
            <tr>
                <td>${name}</td>
                <td>${emirate}</td>
                <td>${vehicle}</td>
                <td>${experience}</td>
                <td>${available}</td>
                <td>${date}</td>
            </tr>
        `;
    }).join('');
}

// Helper function to escape HTML and prevent XSS
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Initialize
loadData();
</script>
</body>
</html>
